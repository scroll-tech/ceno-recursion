const u32 SPONGE_WIDTH = 12

const field[360] ALL_ROUND_CONSTANTS = [
    (F)0xb585f766f2144405, (F)0x7746a55f43921ad7, (F)0xb2fb0d31cee799b4, (F)0x0f6760a4803427d7,
    (F)0xe10d666650f4e012, (F)0x8cae14cb07d09bf1, (F)0xd438539c95f63e9f, (F)0xef781c7ce35b4c3d,
    (F)0xcdc4a239b0c44426, (F)0x277fa208bf337bff, (F)0xe17653a29da578a1, (F)0xc54302f225db2c76,
    (F)0x86287821f722c881, (F)0x59cd1a8a41c18e55, (F)0xc3b919ad495dc574, (F)0xa484c4c5ef6a0781,
    (F)0x308bbd23dc5416cc, (F)0x6e4a40c18f30c09c, (F)0x9a2eedb70d8f8cfa, (F)0xe360c6e0ae486f38,
    (F)0xd5c7718fbfc647fb, (F)0xc35eae071903ff0b, (F)0x849c2656969c4be7, (F)0xc0572c8c08cbbbad,
    (F)0xe9fa634a21de0082, (F)0xf56f6d48959a600d, (F)0xf7d713e806391165, (F)0x8297132b32825daf,
    (F)0xad6805e0e30b2c8a, (F)0xac51d9f5fcf8535e, (F)0x502ad7dc18c2ad87, (F)0x57a1550c110b3041,
    (F)0x66bbd30e6ce0e583, (F)0x0da2abef589d644e, (F)0xf061274fdb150d61, (F)0x28b8ec3ae9c29633,
    (F)0x92a756e67e2b9413, (F)0x70e741ebfee96586, (F)0x019d5ee2af82ec1c, (F)0x6f6f2ed772466352,
    (F)0x7cf416cfe7e14ca1, (F)0x61df517b86a46439, (F)0x85dc499b11d77b75, (F)0x4b959b48b9c10733,
    (F)0xe8be3e5da8043e57, (F)0xf5c0bc1de6da8699, (F)0x40b12cbf09ef74bf, (F)0xa637093ecb2ad631,
    (F)0x3cc3f892184df408, (F)0x2e479dc157bf31bb, (F)0x6f49de07a6234346, (F)0x213ce7bede378d7b,
    (F)0x5b0431345d4dea83, (F)0xa2de45780344d6a1, (F)0x7103aaf94a7bf308, (F)0x5326fc0d97279301,
    (F)0xa9ceb74fec024747, (F)0x27f8ec88bb21b1a3, (F)0xfceb4fda1ded0893, (F)0xfac6ff1346a41675,
    (F)0x7131aa45268d7d8c, (F)0x9351036095630f9f, (F)0xad535b24afc26bfb, (F)0x4627f5c6993e44be,
    (F)0x645cf794b8f1cc58, (F)0x241c70ed0af61617, (F)0xacb8e076647905f1, (F)0x3737e9db4c4f474d,
    (F)0xe7ea5e33e75fffb6, (F)0x90dee49fc9bfc23a, (F)0xd1b1edf76bc09c92, (F)0x0b65481ba645c602,
    (F)0x99ad1aab0814283b, (F)0x438a7c91d416ca4d, (F)0xb60de3bcc5ea751c, (F)0xc99cab6aef6f58bc,
    (F)0x69a5ed92a72ee4ff, (F)0x5e7b329c1ed4ad71, (F)0x5fc0ac0800144885, (F)0x32db829239774eca,
    (F)0x0ade699c5830f310, (F)0x7cc5583b10415f21, (F)0x85df9ed2e166d64f, (F)0x6604df4fee32bcb1,
    (F)0xeb84f608da56ef48, (F)0xda608834c40e603d, (F)0x8f97fe408061f183, (F)0xa93f485c96f37b89,
    (F)0x6704e8ee8f18d563, (F)0xcee3e9ac1e072119, (F)0x510d0e65e2b470c1, (F)0xf6323f486b9038f0,
    (F)0x0b508cdeffa5ceef, (F)0xf2417089e4fb3cbd, (F)0x60e75c2890d15730, (F)0xa6217d8bf660f29c,
    (F)0x7159cd30c3ac118e, (F)0x839b4e8fafead540, (F)0x0d3f3e5e82920adc, (F)0x8f7d83bddee7bba8,
    (F)0x780f2243ea071d06, (F)0xeb915845f3de1634, (F)0xd19e120d26b6f386, (F)0x016ee53a7e5fecc6,
    (F)0xcb5fd54e7933e477, (F)0xacb8417879fd449f, (F)0x9c22190be7f74732, (F)0x5d693c1ba3ba3621,
    (F)0xdcef0797c2b69ec7, (F)0x3d639263da827b13, (F)0xe273fd971bc8d0e7, (F)0x418f02702d227ed5,
    (F)0x8c25fda3b503038c, (F)0x2cbaed4daec8c07c, (F)0x5f58e6afcdd6ddc2, (F)0x284650ac5e1b0eba,
    (F)0x635b337ee819dab5, (F)0x9f9a036ed4f2d49f, (F)0xb93e260cae5c170e, (F)0xb0a7eae879ddb76d,
    (F)0xd0762cbc8ca6570c, (F)0x34c6efb812b04bf5, (F)0x40bf0ab5fa14c112, (F)0xb6b570fc7c5740d3,
    (F)0x5a27b9002de33454, (F)0xb1a5b165b6d2b2d2, (F)0x8722e0ace9d1be22, (F)0x788ee3b37e5680fb,
    (F)0x14a726661551e284, (F)0x98b7672f9ef3b419, (F)0xbb93ae776bb30e3a, (F)0x28fd3b046380f850,
    (F)0x30a4680593258387, (F)0x337dc00c61bd9ce1, (F)0xd5eca244c7a4ff1d, (F)0x7762638264d279bd,
    (F)0xc1e434bedeefd767, (F)0x0299351a53b8ec22, (F)0xb2d456e4ad251b80, (F)0x3e9ed1fda49cea0b,
    (F)0x2972a92ba450bed8, (F)0x20216dd77be493de, (F)0xadffe8cf28449ec6, (F)0x1c4dbb1c4c27d243,
    (F)0x15a16a8a8322d458, (F)0x388a128b7fd9a609, (F)0x2300e5d6baedf0fb, (F)0x2f63aa8647e15104,
    (F)0xf1c36ce86ecec269, (F)0x27181125183970c9, (F)0xe584029370dca96d, (F)0x4d9bbc3e02f1cfb2,
    (F)0xea35bc29692af6f8, (F)0x18e21b4beabb4137, (F)0x1e3b9fc625b554f4, (F)0x25d64362697828fd,
    (F)0x5a3f1bb1c53a9645, (F)0xdb7f023869fb8d38, (F)0xb462065911d4e1fc, (F)0x49c24ae4437d8030,
    (F)0xd793862c112b0566, (F)0xaadd1106730d8feb, (F)0xc43b6e0e97b0d568, (F)0xe29024c18ee6fca2,
    (F)0x5e50c27535b88c66, (F)0x10383f20a4ff9a87, (F)0x38e8ee9d71a45af8, (F)0xdd5118375bf1a9b9,
    (F)0x775005982d74d7f7, (F)0x86ab99b4dde6c8b0, (F)0xb1204f603f51c080, (F)0xef61ac8470250ecf,
    (F)0x1bbcd90f132c603f, (F)0x0cd1dabd964db557, (F)0x11a3ae5beb9d1ec9, (F)0xf755bfeea585d11d,
    (F)0xa3b83250268ea4d7, (F)0x516306f4927c93af, (F)0xddb4ac49c9efa1da, (F)0x64bb6dec369d4418,
    (F)0xf9cc95c22b4c1fcc, (F)0x08d37f755f4ae9f6, (F)0xeec49b613478675b, (F)0xf143933aed25e0b0,
    (F)0xe4c5dd8255dfc622, (F)0xe7ad7756f193198e, (F)0x92c2318b87fff9cb, (F)0x739c25f8fd73596d,
    (F)0x5636cac9f16dfed0, (F)0xdd8f909a938e0172, (F)0xc6401fe115063f5b, (F)0x8ad97b33f1ac1455,
    (F)0x0c49366bb25e8513, (F)0x0784d3d2f1698309, (F)0x530fb67ea1809a81, (F)0x410492299bb01f49,
    (F)0x139542347424b9ac, (F)0x9cb0bd5ea1a1115e, (F)0x02e3f615c38f49a1, (F)0x985d4f4a9c5291ef,
    (F)0x775b9feafdcd26e7, (F)0x304265a6384f0f2d, (F)0x593664c39773012c, (F)0x4f0a2e5fb028f2ce,
    (F)0xdd611f1000c17442, (F)0xd8185f9adfea4fd0, (F)0xef87139ca9a3ab1e, (F)0x3ba71336c34ee133,
    (F)0x7d3a455d56b70238, (F)0x660d32e130182684, (F)0x297a863f48cd1f43, (F)0x90e0a736a751ebb7,
    (F)0x549f80ce550c4fd3, (F)0x0f73b2922f38bd64, (F)0x16bf1f73fb7a9c3f, (F)0x6d1f5a59005bec17,
    (F)0x02ff876fa5ef97c4, (F)0xc5cb72a2a51159b0, (F)0x8470f39d2d5c900e, (F)0x25abb3f1d39fcb76,
    (F)0x23eb8cc9b372442f, (F)0xd687ba55c64f6364, (F)0xda8d9e90fd8ff158, (F)0xe3cbdc7d2fe45ea7,
    (F)0xb9a8c9b3aee52297, (F)0xc0d28a5c10960bd3, (F)0x45d7ac9b68f71a34, (F)0xeeb76e397069e804,
    (F)0x3d06c8bd1514e2d9, (F)0x9c9c98207cb10767, (F)0x65700b51aedfb5ef, (F)0x911f451539869408,
    (F)0x7ae6849fbc3a0ec6, (F)0x3bb340eba06afe7e, (F)0xb46e9d8b682ea65e, (F)0x8dcf22f9a3b34356,
    (F)0x77bdaeda586257a7, (F)0xf19e400a5104d20d, (F)0xc368a348e46d950f, (F)0x9ef1cd60e679f284,
    (F)0xe89cd854d5d01d33, (F)0x5cd377dc8bb882a2, (F)0xa7b0fb7883eee860, (F)0x7684403ec392950d,
    (F)0x5fa3f06f4fed3b52, (F)0x8df57ac11bc04831, (F)0x2db01efa1e1e1897, (F)0x54846de4aadb9ca2,
    (F)0xba6745385893c784, (F)0x541d496344d2c75b, (F)0xe909678474e687fe, (F)0xdfe89923f6c9c2ff,
    (F)0xece5a71e0cfedc75, (F)0x5ff98fd5d51fe610, (F)0x83e8941918964615, (F)0x5922040b47f150c1,
    (F)0xf97d750e3dd94521, (F)0x5080d4c2b86f56d7, (F)0xa7de115b56c78d70, (F)0x6a9242ac87538194,
    (F)0xf7856ef7f9173e44, (F)0x2265fc92feb0dc09, (F)0x17dfc8e4f7ba8a57, (F)0x9001a64209f21db8,
    (F)0x90004c1371b893c5, (F)0xb932b7cf752e5545, (F)0xa0b1df81b6fe59fc, (F)0x8ef1dd26770af2c2,
    (F)0x0541a4f9cfbeed35, (F)0x9e61106178bfc530, (F)0xb3767e80935d8af2, (F)0x0098d5782065af06,
    (F)0x31d191cd5c1466c7, (F)0x410fefafa319ac9d, (F)0xbdf8f242e316c4ab, (F)0x9e8cd55b57637ed0,
    (F)0xde122bebe9a39368, (F)0x4d001fd58f002526, (F)0xca6637000eb4a9f8, (F)0x2f2339d624f91f78,
    (F)0x6d1a7918c80df518, (F)0xdf9a4939342308e9, (F)0xebc2151ee6c8398c, (F)0x03cc2ba8a1116515,
    (F)0xd341d037e840cf83, (F)0x387cb5d25af4afcc, (F)0xbba2515f22909e87, (F)0x7248fe7705f38e47,
    (F)0x4d61e56a525d225a, (F)0x262e963c8da05d3d, (F)0x59e89b094d220ec2, (F)0x055d5b52b78b9c5e,
    (F)0x82b27eb33514ef99, (F)0xd30094ca96b7ce7b, (F)0xcf5cb381cd0a1535, (F)0xfeed4db6919e5a7c,
    (F)0x41703f53753be59f, (F)0x5eeea940fcde8b6f, (F)0x4cd1f1b175100206, (F)0x4a20358574454ec0,
    (F)0x1478d361dbbf9fac, (F)0x6f02dc07d141875c, (F)0x296a202ed8e556a2, (F)0x2afd67999bf32ee5,
    (F)0x7acfd96efa95491d, (F)0x6798ba0c0abb2c6d, (F)0x34c6f57b26c92122, (F)0x5736e1bad206b5de,
    (F)0x20057d2a0056521b, (F)0x3dea5bd5d0578bd7, (F)0x16e50d897d4634ac, (F)0x29bff3ecb9b7a6e3,
    (F)0x475cd3205a3bdcde, (F)0x18a42105c31b7e88, (F)0x023e7414af663068, (F)0x15147108121967d7,
    (F)0xe4a3dff1d7d6fef9, (F)0x01a8d1a588085737, (F)0x11b4c74eda62beef, (F)0xe587cc0d69a73346,
    (F)0x1ff7327017aa2a6e, (F)0x594e29c42473d06b, (F)0xf6f31db1899b12d5, (F)0xc02ac5e47312d3ca,
    (F)0xe70201e960cb78b8, (F)0x6f90ff3b6a65f108, (F)0x42747a7245e7fa84, (F)0xd1f507e43ab749b2,
    (F)0x1c86d265f15750cd, (F)0x3996ce73dd832c1c, (F)0x8e7fba02983224bd, (F)0xba0dec7103255dd4,
    (F)0x9e9cbd781628fc5b, (F)0xdae8645996edd6a5, (F)0xdebe0853b1a1d378, (F)0xa49229d24d014343,
    (F)0x7be5b9ffda905e1c, (F)0xa3c95eaec244aa30, (F)0x0230bca8f4df0544, (F)0x4135c2bebfe148c6,
    (F)0x166fc0cc438a3c72, (F)0x3762b59a8ae83efa, (F)0xe8928a4c89114750, (F)0x2a440b51a4945ee5,
    (F)0x80cefd2b7d99ff83, (F)0xbb9879c6e61fd62a, (F)0x6e7c8f1a84265034, (F)0x164bb2de1bbeddc8,
    (F)0xf3c12fe54d5c653b, (F)0x40b9e922ed9771e2, (F)0x551f5b0fbe7b1840, (F)0x25032aa7c4cb1811,
    (F)0xaaed34074b164346, (F)0x8ffd96bbf9c9c81d, (F)0x70fc91eb5937085c, (F)0x7f795e2a5f915440,
    (F)0x4543d9df5476d3cb, (F)0xf172d73e004fc90d, (F)0xdfd1c4febcc81238, (F)0xbc8dfb627fe558fc
]

const field[12] MDS_MATRIX_CIRC = [17, 15, 41, 16, 2, 28, 13, 13, 39, 18, 34, 20]

const field[12] MDS_MATRIX_DIAG = [8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

const field[12] FAST_PARTIAL_FIRST_ROUND_CONSTANT = [
    (F)0x3cc3f892184df408, (F)0xe993fd841e7e97f1, (F)0xf2831d3575f0f3af, (F)0xd2500e0a350994ca,
    (F)0xc5571f35d7288633, (F)0x91d89c5184109a02, (F)0xf37f925d04e5667b, (F)0x2d6e448371955a69,
    (F)0x740ef19ce01398a1, (F)0x694d24c0752fdf45, (F)0x60936af96ee2f148, (F)0xc33448feadc78f0c
]

const field[22] FAST_PARTIAL_ROUND_CONSTANTS = [
    (F)0x74cb2e819ae421ab, (F)0xd2559d2370e7f663, (F)0x62bf78acf843d17c, (F)0xd5ab7b67e14d1fb4,
    (F)0xb9fe2ae6e0969bdc, (F)0xe33fdf79f92a10e8, (F)0x0ea2bb4c2b25989b, (F)0xca9121fbf9d38f06,
    (F)0xbdd9b0aa81f58fa4, (F)0x83079fa4ecf20d7e, (F)0x650b838edfcc4ad3, (F)0x77180c88583c76ac,
    (F)0xaf8c20753143a180, (F)0xb8ccfe9989a39175, (F)0x954a1729f60cc9c5, (F)0xdeb5b550c4dca53b,
    (F)0xf01bb0b00f77011e, (F)0xa1ebb404b676afd9, (F)0x860b6e1597a0173e, (F)0x308bb65a036acbce,
    (F)0x1aca78f31c97c876, 0
]